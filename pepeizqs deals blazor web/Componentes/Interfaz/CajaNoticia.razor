@using Noticias

<script>
	function enseñarTooltip(e, id) {
		var x = e.clientX,
			y = e.clientY;

		var tooltip = document.getElementById(id);

		if (screen.width / 2 > x) {
			tooltip.style.top = (y + 10) + 'px';
			tooltip.style.left = (x + 20) + 'px';
		}
		else {
			tooltip.style.top = (y - 10) + 'px';
			tooltip.style.left = (x - 20 - tooltip.getBoundingClientRect().width) + 'px';
		};
	}
</script>

<style>
	.cnoticia-expandir {
		transition: transform .2s;
		box-shadow: 0px 2px 4px 0px rgba(0, 0, 0, 0.28),0px 0px 1px 0px rgba(0, 0, 0, 0.24);
		border: 1px solid var(--fondoBotonPequeño);
		height: 100%;
		width: 100%;
		background-image: linear-gradient(to bottom in oklab, var(--fondoOscuro), var(--fondoMinimo));
		display: flex;
		align-items: center;
		flex-direction: column;
	}

	.cnoticia-expandir:hover {
		transform: scale(1.01);
		box-shadow: 0px 4px 8px 0px rgba(0, 0, 0, 0.5),0px 0px 2px 0px rgba(0, 0, 0, 0.5);
	}
</style>

<div class="tooltip-juego" onmousemove="enseñarTooltip(event, 'tooltip-news-@noticia.Id.ToString()')" style="width: 100%; display: flex; align-items: center; flex: 0 0 400px;">
	<a href="/news/@noticia.Id/@Herramientas.EnlaceAdaptador.Nombre(titulo)/" style="cursor: pointer; text-decoration: none; color: var(--colorTexto); height: 100%;">
		<div class="cnoticia-expandir" title="@titulo">
			<div style="display: flex; align-items: center; gap: 15px; background-color: var(--fondoBotonPequeño); padding: 15px 20px; width: 100%;">
				@{
					string icono = string.Empty;
					string etiqueta = string.Empty;

					if (noticia.NoticiaTipo == NoticiaTipo.Bundles)
					{
						icono = Bundles2.BundlesCargar.DevolverBundle(noticia.BundleTipo).ImagenIcono;
						etiqueta = Herramientas.Idiomas.BuscarTexto(idioma, "Type2", "News");
					}
					else if (noticia.NoticiaTipo == NoticiaTipo.Gratis)
					{
						icono = Gratis2.GratisCargar.DevolverGratis(noticia.GratisTipo).ImagenIcono;
						etiqueta = Herramientas.Idiomas.BuscarTexto(idioma, "Type3", "News");
					}
					else if (noticia.NoticiaTipo == NoticiaTipo.Suscripciones)
					{
						icono = Suscripciones2.SuscripcionesCargar.DevolverSuscripcion(noticia.SuscripcionTipo).ImagenIcono;
						etiqueta = Herramientas.Idiomas.BuscarTexto(idioma, "Type4", "News");
					}
					else if (noticia.NoticiaTipo == NoticiaTipo.Web)
					{
						icono = "/favicons/favicon-96x96.png";
						etiqueta = Herramientas.Idiomas.BuscarTexto(idioma, "Type9", "News");
					}

					if (string.IsNullOrEmpty(icono) == false)
					{
						<div style="display: flex;">
							<img src="@Herramientas.Ficheros.Imagenes.ServidorExterno(icono, 18, 18)" style="width: 18px; height: 18px;" alt="@Noticias.NoticiasCargar.Traduccion(noticia.NoticiaTipo, idioma)" />
						</div>
					}

					if (string.IsNullOrEmpty(etiqueta) == false)
					{
						<div style="font-size: 14px;">
							@etiqueta
						</div>
					}
				}

				<div style="font-size: 14px; margin-left: auto;">
					@mensajeTiempo
				</div>
			</div>

			<img src="@Herramientas.Ficheros.Imagenes.ServidorExterno(noticia.Imagen)" style="width: 100%; height: 100%; object-fit: contain;" alt="@titulo" />
		</div>
	</a>

	<div id="tooltip-news-@noticia.Id.ToString()" class="tooltip-relleno">
		<div style="margin: 8px; max-width: 300px; font-size: 14px;">
			@titulo
		</div>
	</div>
</div>

@code {

	#nullable disable

	[Parameter]
	public string idioma { get; set; }

	[Parameter]
	public Noticias.Noticia noticia { get; set; }

	[Parameter]
	public Tipo tipo { get; set; } = Tipo.Desconocido;

	public enum Tipo
	{
		Desconocido,
		Portada,
		UltimasNoticias
	}

	private string titulo = string.Empty;
	private string mensajeTiempo = string.Empty;

	protected override async Task OnAfterRenderAsync(bool primerRender)
	{
		titulo = Herramientas.Idiomas.ElegirTexto(idioma, noticia.TituloEn, noticia.TituloEs);
		mensajeTiempo = Herramientas.Calculadora.DiferenciaTiempo(noticia.FechaEmpieza, idioma);
	}
}
